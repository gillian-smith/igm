# @package _global_

hydra:
  run:
    dir: outputs

defaults:
  - /user/conf/inputs@inputs.init_state: init_state
  - override /inputs:
    - init_state
  - override /processes:
    - iceflow
  - override /outputs:
    - write_ncdf

processes:
  iceflow:
    method: unified
    physics:
      energy_components: [viscosity, gravity, sliding]
      sliding:
        law: weertman
        weertman:
          exponent: 1.0
    unified:
      bcs: [periodic_ns, periodic_we]
      optimizer: lbfgs
      nbit_init: 10000
      line_search: armijo
      network:
        pretrained: False
      halt:
        freq: 1
        success:
          - criterion: rel_tol
            metric: cost
            rel_tol:
              tol: 1e-8
          - criterion: rel_tol
            metric: u
            rel_tol:
              tol: 1e-8
        failure:
          - criterion: nan
            metric: u
          - criterion: inf
            metric: u
      display:
        print_cost: True
    numerics:
      Nz: 2
      basis_vertical: molho

outputs:
  write_ncdf:
    output_file: results.nc
    vars_to_save: [topg, usurf, thk, velbar_mag, velsurf_mag, velbase_mag, slidingco]
